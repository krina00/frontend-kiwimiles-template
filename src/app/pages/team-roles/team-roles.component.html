<div class="header bg-gradient-danger py-7 py-lg-8">
  <div class="container">
    <div class="header-body text-center mb-7">
      <div class="row justify-content-center">
        <div class="col-lg-5 col-md-6">
          <h2 class="text-white">{{teamName}}</h2>
        </div>
      </div>
    </div>
  </div>
</div>
<p-dialog header="Error" [(visible)]="displayError" [style]="{'width': '30vw'}" [baseZIndex]="10000">
  <p style="color: red;"><strong>{{error}}</strong></p>
</p-dialog>
<div class="container mt--8 pb-5">
  <div class="row justify-content-center">

    <p-table *ngIf="!roles" styleClass="p-datatable-striped">
      <ng-template pTemplate="header">
        <tr>
          <th>
            <center>No roles present at this moment</center>
          </th>
        </tr>
      </ng-template>
    </p-table>

    <p-table *ngIf="roles && selectAll" [value]="roles" styleClass="p-datatable-striped">
      <ng-template pTemplate="header">
        <tr>
          <th colspan="3">
            <center style="font-size: larger">{{teamName}} Roles</center>
            <label class="ml-4" style="float: right;">Update Roles</label>
            <label class="switch" style="float: right;">
              <input type="checkbox" [(ngModel)]="selectAll" checked>
              <span class="slider round"></span>
            </label>
          </th>
        </tr>
        <tr>
          <th class="text-center">#</th>
          <th class="text-center">Roles</th>
          <th class="text-center">
            <span class="mr-4">Select all</span>
            <p-checkbox binary = "true" [(ngModel)]="isAllocateAllRoles" 
                (onChange) = "selectAllRoles()">
            </p-checkbox>
          </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-role let-i="rowIndex">
        <tr>
          <td class="text-center">{{i+1}}</td>
          <td class="text-center">
            {{role.name}}
          </td>
          <td class="text-center">
            <p-checkbox binary = "true" [(ngModel)]="role.isAllocated"></p-checkbox>
            <i class="fa fa-lock ml-5 text-primary" aria-hidden="true" (click)="getAllPermissions(role.id)"></i>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <p-table *ngIf="givenRoles && !selectAll" [value]="givenRoles" styleClass="p-datatable-striped">
      <ng-template pTemplate="header">
        <tr>
          <th *ngIf= "!isDefaultTeam" colspan="3">
            <center style="font-size: larger">{{teamName}} Roles</center>
            <label class="ml-4" style="float: right;">Update Roles</label>
            <label class="switch" style="float: right;">
              <input type="checkbox" [(ngModel)]="selectAll" checked>
              <span class="slider round"></span>
            </label>
          </th>
          <th *ngIf= "isDefaultTeam" colspan="3">
            <center style="font-size: larger">{{teamName}} Roles</center>
          </th>
        </tr>
        <tr *ngIf="givenRoles.length == 0">
          <th colspan="3">
            <center>No roles given</center>
          </th>
        </tr>
        <tr *ngIf="givenRoles.length > 0">
          <th class="text-center">#</th>
          <th class="text-center">Roles</th>
          <th class="text-center">Action</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-role let-i="rowIndex">
        <tr *ngIf="role.isAllocated">
          <td class="text-center">{{i+1}}</td>
          <td class="text-center">
            {{role.name}}
          </td>
          <td class="text-center">
            <!-- <p-checkbox binary = "true" [(ngModel)]="role.isAllocated"></p-checkbox> -->
            <i class="fa fa-lock ml-5 text-primary" aria-hidden="true" (click)="getAllPermissions(role.id)"></i>
          </td>
        </tr>
      </ng-template>
    </p-table>
    <div class="mt-4">
      <span class="mr-4">
        <button *ngIf ="selectAll" pButton type="button" class="p-button p-button-help p-button-rounded"
                label="Update" (click)="updateTeamRoles()">
        </button>
      </span>
    </div>
  </div>
</div>
  