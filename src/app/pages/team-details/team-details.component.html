<div class="header bg-gradient-danger py-7 py-lg-8">
  <div class="container">
    <div class="header-body text-center mb-7">
      <div class="row justify-content-center">
        <div class="col-lg-5 col-md-6">
          <h2 class="text-white">{{teamName}}</h2>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container mt--8 pb-5">
  <div class="row justify-content-center">
    <p-table *ngIf="members" [value]="members" styleClass="p-datatable-striped">
      <ng-template pTemplate="header">
        <tr>
          <th colspan="6">
            Members
          </th>
        </tr>
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Gender</th>
          <th>Role</th>
          <th>Joined</th>
          <th></th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" class="text-center" let-member let-i="rowIndex">
        <tr>
          <td>{{i+1}}</td>
          <td>
            <img src={{member.profilePictureUrl}} style="height:inherit; width:8%;" />
            {{member.name}}
            <p-badge *ngIf="member.badgeEnabled" value="You" severity="success"></p-badge>
          </td>
          <td>{{member.gender}}</td>
          <td *ngIf="!member.updatable">
            {{member.role}}
            <i *ngIf="hasPermission('UPDATE')" class="fas fa-edit m-4 text-info" aria-hidden="true"
               (click)="editMember(member.id)"></i>
          </td>
          <td *ngIf="member.updatable">
            <p-dropdown appendTo="body" [options]="roles" [(ngModel)]="member.role" optionLabel="name"
                        optionValue="code">
            </p-dropdown>
          </td>
          <td>{{member.since}}</td>
          <td *ngIf="!member.updatable">
            <i *ngIf="hasPermission('DELETE')" class="fa fa-trash-alt m-4 text-danger" (click)="deleteMember(member.id)"></i>
          </td>
          <td *ngIf="member.updatable">
            <i class="fas fa-save mr-4 text-blue" aria-hidden="true" (click)="updateMember(member.id)"></i>
            <i class="fa fa-times text-danger" (click)="closeEditMember(member.id)"></i>
          </td>
        </tr>
      </ng-template>

    </p-table>
    <p-dialog header="Error" [(visible)]="displayError" [style]="{'width': '30vw'}" [baseZIndex]="10000">
      <p style="color: red;"><strong>{{error}}</strong></p>
    </p-dialog>
    <div class="mt-4">
      <span *ngIf="hasPermission('ADD')" class="mr-4">
        <button pButton type="button" class="p-button p-button-help p-button-rounded"
                label="Invite a new member" (click)="addMember()">
        </button>
      </span>
      <span class="mr-4">
        <button pButton *ngIf="userRoleInTeam != 'SUDO'" type="button" class="p-button p-button-help p-button-rounded"
                label="Go to all teams" [routerLink]="['/admin/teams']">
        </button>
        <button pButton *ngIf="userRoleInTeam == 'SUDO'" type="button" class="p-button p-button-help p-button-rounded"
                label="Go to all teams" [routerLink]="['/admin/all-teams']">
        </button>
      </span>
    </div>
  </div>
</div>
